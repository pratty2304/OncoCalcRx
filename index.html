<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OncoCalcRx</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z49JKP7QZ4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'G-Z49JKP7QZ4', {
            page_title: 'OncoCalcRx - Chemotherapy Dose Calculator',
            page_location: window.location.href
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 0 20px 20px 20px;
            position: relative;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 16px;
        }

        .form-section {
            background: white;
            padding: 20px 25px 20px 25px !important;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            margin-bottom: 15px;
            margin-top: 15px !important;
        }

        .form-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .calculate-btn {
            background: #3498db;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }

        .calculate-btn:hover {
            background: #2980b9;
        }

        .calculate-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .results {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
            display: none;
        }

        .results h2 {
            color: #27ae60;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .result-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }

        .result-item strong {
            color: #2c3e50;
        }

        .hidden {
            display: none;
        }

        /* Multi-page navigation styles */
        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        .page.active {
            display: block;
            opacity: 1;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        /* Simple radio button styling */
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 0;
            cursor: pointer;
            user-select: none;
        }
        
        .radio-option input[type="radio"] {
            width: 16px;
            height: 16px;
            margin: 0;
            accent-color: #3498db;
        }
        
        .radio-option span {
            font-weight: 500;
            font-size: 14px;
            color: #2c3e50;
        }
        
        .radio-option:hover span {
            color: #3498db;
        }

        .progress-bar {
            background: #ecf0f1;
            height: 6px;
            border-radius: 3px;
            margin-bottom: 0 !important;
            overflow: hidden;
        }

        /* SIMPLE FIX - DIRECT POSITIONING */
        .page.active {
            position: absolute;
            top: 30px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            margin: 0;
            padding: 0;
            overflow-y: auto;
        }

        /* Pages 2 and 3 specific styling */
        #page2.page.active,
        #page3.page.active {
            overflow-y: auto;
        }

        /* Better vertical centering for page 1 */
        #page1.page.active {
            top: 60px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: calc(100vh - 60px);
            overflow: hidden;
        }

        #page1 .form-section {
            width: 100%;
            max-width: 500px;
            margin-top: 30px;
            margin-bottom: 30px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #3498db, #2ecc71);
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            margin-top: 0;
        }

        .page-number {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        /* Search functionality styles */
        .search-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border: 2px dashed #e9ecef;
        }

        .search-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-icon {
            font-size: 20px;
        }

        .search-input {
            position: relative;
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 5px 5px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        /* Copyright Footer Styles */
        .app-footer {
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            padding: 20px 0;
            margin-top: 40px;
            text-align: center;
            position: relative;
            bottom: 0;
            width: 100%;
        }

        .footer-content {
            max-width: 600px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .copyright-line {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .brand-line {
            font-size: 13px;
            color: #868e96;
            font-weight: 400;
        }

        /* Desktop styles for responsive tables */
        .responsive-table {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
        }

        .responsive-table table {
            width: 100%;
            font-size: 14px;
            table-layout: fixed;
            border-collapse: collapse;
        }

        .responsive-table th,
        .responsive-table td {
            padding: 12px;
            border: 1px solid #dee2e6;
            word-wrap: break-word;
            vertical-align: middle;
        }

        /* Page 4 dose adjustment table desktop styles */
        #doseAdjustmentTable .responsive-table {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
        }

        #doseAdjustmentTable .responsive-table table {
            width: 100%;
            font-size: 14px;
            table-layout: fixed;
            border-collapse: collapse;
            min-width: 600px;
        }

        #doseAdjustmentTable .responsive-table th {
            padding: 12px;
            border: 1px solid #dee2e6;
            word-wrap: break-word;
            vertical-align: middle;
            font-size: 14px;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            color: #2c3e50;
            font-weight: 600;
        }

        #doseAdjustmentTable .responsive-table td {
            padding: 12px;
            border: 1px solid #e8f4f8;
            word-wrap: break-word;
            vertical-align: middle;
            font-size: 14px;
            background: #fafbfc;
        }

        #doseAdjustmentTable .responsive-table tbody tr:nth-child(even) td {
            background: #f1f8ff;
        }

        #doseAdjustmentTable .responsive-table tbody tr:hover td {
            background: #e3f2fd;
            transition: background-color 0.2s ease;
        }

        /* Page 4 desktop column widths */
        #doseAdjustmentTable .responsive-table th:nth-child(1),
        #doseAdjustmentTable .responsive-table td:nth-child(1) {
            width: 20%;
        }

        #doseAdjustmentTable .responsive-table th:nth-child(2),
        #doseAdjustmentTable .responsive-table td:nth-child(2) {
            width: 10%;
        }

        #doseAdjustmentTable .responsive-table th:nth-child(3),
        #doseAdjustmentTable .responsive-table td:nth-child(3) {
            width: 12%;
            text-align: center;
        }

        #doseAdjustmentTable .responsive-table th:nth-child(4),
        #doseAdjustmentTable .responsive-table td:nth-child(4) {
            width: 12%;
        }

        /* Drug names column - allow wrapping with fixed width */
        #doseAdjustmentTable .responsive-table td:nth-child(1) {
            white-space: normal;
            word-break: break-word;
            hyphens: auto;
        }

        /* Desktop input styling */
        #doseAdjustmentTable input[type="number"] {
            padding: 8px 30px 8px 8px;
            font-size: 14px;
            width: 100%;
            border: 2px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        /* Smaller reduce column inputs to match global reduction input */
        #doseAdjustmentTable .responsive-table td:nth-child(3) input[type="number"] {
            width: 80px;
            max-width: 80px;
        }

        #doseAdjustmentTable .percentage-symbol {
            right: 12px;
            font-size: 11px;
            top: 50%;
            transform: translateY(-50%);
            position: absolute;
            color: #666;
            pointer-events: none;
            font-weight: 500;
        }

        /* Desktop column widths for Page 3 (5 columns) - Focus on schedule column */
        .responsive-table table {
            min-width: 600px;
        }
        
        .responsive-table th:nth-child(1),
        .responsive-table td:nth-child(1) {
            width: 22%;
        }

        .responsive-table th:nth-child(2),
        .responsive-table td:nth-child(2) {
            width: 22%;
        }

        .responsive-table th:nth-child(3),
        .responsive-table td:nth-child(3) {
            width: 22%;
        }

        .responsive-table th:nth-child(4),
        .responsive-table td:nth-child(4) {
            width: 18%;
        }

        .responsive-table th:nth-child(5),
        .responsive-table td:nth-child(5) {
            width: 26%;
        }

        /* Desktop styles for Page 5 final prescription table (6 columns) */
        #finalResultsContent .responsive-table {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
            max-width: 100%;
        }

        #finalResultsContent .responsive-table table {
            width: 100%;
            table-layout: fixed;
            border-collapse: collapse;
            min-width: 700px;
            max-width: 100%;
        }

        #finalResultsContent .responsive-table th:nth-child(1),
        #finalResultsContent .responsive-table td:nth-child(1) {
            width: 20%;
        }

        #finalResultsContent .responsive-table th:nth-child(2),
        #finalResultsContent .responsive-table td:nth-child(2) {
            width: 15%;
        }

        #finalResultsContent .responsive-table th:nth-child(3),
        #finalResultsContent .responsive-table td:nth-child(3) {
            width: 15%;
        }

        #finalResultsContent .responsive-table th:nth-child(4),
        #finalResultsContent .responsive-table td:nth-child(4) {
            width: 15%;
        }

        #finalResultsContent .responsive-table th:nth-child(5),
        #finalResultsContent .responsive-table td:nth-child(5) {
            width: 15%;
        }

        #finalResultsContent .responsive-table th:nth-child(6),
        #finalResultsContent .responsive-table td:nth-child(6) {
            width: 20%;
        }

        /* Allow drug names and schedule to wrap on desktop */
        .responsive-table td:nth-child(1),
        .responsive-table td:nth-child(5),
        #finalResultsContent .responsive-table td:nth-child(1),
        #finalResultsContent .responsive-table td:nth-child(6) {
            white-space: normal;
            word-break: break-word;
            hyphens: auto;
        }

        /* Keep dose columns compact on desktop */
        .responsive-table td:nth-child(2),
        .responsive-table td:nth-child(3),
        .responsive-table td:nth-child(4),
        #finalResultsContent .responsive-table td:nth-child(2),
        #finalResultsContent .responsive-table td:nth-child(3),
        #finalResultsContent .responsive-table td:nth-child(4),
        #finalResultsContent .responsive-table td:nth-child(5) {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .suggestion-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.2s;
        }

        .suggestion-item:hover {
            background: #f8f9fa;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-protocol {
            font-weight: 600;
            color: #2c3e50;
        }

        .suggestion-cancer {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 2px;
        }

        .divider {
            text-align: center;
            margin: 25px 0;
            position: relative;
            color: #7f8c8d;
            font-weight: 600;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #dee2e6;
            z-index: 1;
        }

        .divider span {
            background: white;
            padding: 0 15px;
            position: relative;
            z-index: 2;
        }

        .browse-section {
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .browse-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .selected-protocol-info {
            background: #e8f5e8;
            border: 1px solid #28a745;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        .selected-protocol-name {
            font-weight: 600;
            color: #155724;
            margin-bottom: 5px;
        }

        .selected-protocol-cancer {
            font-size: 14px;
            color: #6c757d;
        }

        /* Splash Screen Styles */
        .splash-content {
            min-height: 80vh;
            background: url('splash-bg.jpg') center center / cover no-repeat;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }


        .splash-content h1 {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInUp 0.8s ease-out;
        }

        .splash-content p {
            font-size: 20px;
            opacity: 0.9;
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .form-row {
                flex-direction: column;
            }
            
            .container {
                padding: 10px;
            }

            /* Enhanced form sections on mobile - increased vertical space */
            .form-section {
                padding: 18px !important;
                margin-bottom: 15px;
                margin-top: 15px !important;
                min-height: auto !important;
            }
            
            /* Specific enhancement for page 2 form section */
            #page2 .form-section {
                padding: 20px 18px !important;
                margin-bottom: 18px;
                margin-top: 18px !important;
            }

            /* Better page 1 positioning on mobile - reduced height and centered */
            #page1.page.active {
                top: 40px;
                height: auto;
                min-height: calc(80vh - 40px);
                max-height: calc(85vh - 40px);
                overflow: visible;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 20px 0;
            }

            #page1 .form-section {
                margin-top: 0;
                margin-bottom: 0;
                width: 100%;
                max-width: 500px;
            }

            .splash-content h1 {
                font-size: 36px;
            }

            .splash-content p {
                font-size: 18px;
            }

            .form-section h2 {
                font-size: 18px;
                margin-bottom: 15px;
                padding-bottom: 8px;
            }

            .page-title {
                margin-bottom: 15px;
            }

            .page-number {
                width: 25px;
                height: 25px;
                font-size: 12px;
            }

            /* Compact form inputs */
            .form-group {
                margin-bottom: 15px;
            }

            label {
                margin-bottom: 4px;
                font-size: 14px;
            }

            input, select {
                padding: 10px;
                font-size: 16px;
            }
            
            /* Mobile radio button styling - keep side by side */
            .radio-group {
                gap: 25px;
                margin-top: 15px;
                justify-content: flex-start;
            }
            
            .radio-option {
                gap: 10px;
            }
            
            .radio-option input[type="radio"] {
                width: 18px;
                height: 18px;
                flex-shrink: 0;
            }
            
            .radio-option span {
                font-size: 16px;
                font-weight: 500;
            }
            
            /* Ensure cancer-specific search matches other inputs on mobile */
            #cancerSpecificSearch {
                padding: 10px 30px 10px 10px !important;
                font-size: 16px !important;
            }
            
            #clearCancerSearch {
                right: 6px !important;
                font-size: 14px !important;
                width: 18px !important;
                height: 18px !important;
            }

            /* Larger sex dropdown on mobile */
            #sex {
                font-size: 18px;
                padding: 12px;
                min-height: 48px;
            }

            /* Compact buttons */
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }

            .calculate-btn {
                padding: 12px 24px;
                font-size: 16px;
            }

            /* Compact search and browse sections */
            .search-section {
                padding: 6px !important;
                margin-bottom: 8px !important;
            }
            
            .browse-section {
                padding: 12px;
                margin-bottom: 12px;
            }

            .search-header {
                margin-bottom: 6px !important;
            }
            
            .browse-header {
                margin-bottom: 12px;
            }

            .search-header h3 {
                font-size: 11px !important;
            }
            
            .browse-header h3 {
                font-size: 16px;
            }
            
            /* Compact quick search input on mobile */
            #protocolSearch {
                padding: 5px 20px 5px 5px !important;
                font-size: 12px !important;
            }
            
            /* Compact search suggestions on mobile */
            .search-suggestions {
                max-height: 180px !important;
                font-size: 12px !important;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
            }
            
            .suggestion-item {
                padding: 8px !important;
                border-bottom: 1px solid #f0f0f0 !important;
            }
            
            .suggestion-protocol {
                font-size: 12px !important;
                font-weight: 600 !important;
                line-height: 1.3 !important;
            }
            
            .suggestion-cancer {
                font-size: 10px !important;
                color: #7f8c8d !important;
                margin-top: 2px !important;
                line-height: 1.2 !important;
            }
            
            /* Compact search section carboplatin parameters on mobile */
            #searchCarboplatinParams {
                margin-bottom: 8px !important;
            }
            
            #searchCarboplatinParams > div {
                padding: 10px !important;
                margin-bottom: 8px !important;
                border-width: 1px !important;
                border-radius: 6px !important;
            }
            
            #searchCarboplatinParams h3 {
                font-size: 14px !important;
                margin-bottom: 8px !important;
            }
            
            #searchCarboplatinParams .fas {
                font-size: 14px !important;
            }
            
            #searchCarboplatinParams .form-group {
                margin-bottom: 15px !important;
            }
            
            #searchCarboplatinParams .form-row {
                margin-bottom: 15px !important;
            }
            
            #searchCarboplatinParams .form-row .form-group {
                margin-bottom: 0 !important;
            }
            
            #searchCarboplatinParams label {
                font-size: 13px !important;
                margin-bottom: 3px !important;
            }
            
            #searchCarboplatinParams input {
                padding: 8px !important;
                font-size: 14px !important;
                border-width: 1px !important;
            }
            
            /* Compact selected protocol info on mobile */
            .selected-protocol-info {
                padding: 4px !important;
                margin-top: 4px !important;
            }
            
            .selected-protocol-name {
                font-size: 11px !important;
            }
            
            .selected-protocol-cancer {
                font-size: 9px !important;
            }
            
            /* Ensure consistent sizing for cancer section inputs */
            #cancerType, #cancerSubtype, #cancerSpecificSearchInput, #protocol {
                min-height: 44px !important;
                padding: 10px !important;
                font-size: 16px !important;
                box-sizing: border-box !important;
                height: auto !important;
            }
            
            /* Cancer-specific search styling on mobile - match other inputs exactly */
            #cancerSpecificSearchInput {
                border: 2px solid #ddd !important;
                border-radius: 5px !important;
                padding: 10px 25px 10px 10px !important;
            }
            
            #clearCancerSearch {
                right: 6px !important;
                font-size: 14px !important;
                width: 18px !important;
                height: 18px !important;
            }
            
            #cancerSearchDropdown {
                max-height: 150px !important;
                border: 1px solid #ddd !important;
                border-radius: 0 0 4px 4px !important;
                margin-top: 0 !important;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
            }
            
            .cancer-search-item {
                padding: 8px !important;
            }
            
            .cancer-search-item div:first-child {
                font-size: 14px !important;
                font-weight: 600 !important;
            }
            
            .cancer-search-item div:last-child {
                font-size: 11px !important;
            }

            /* Compact divider */
            .divider {
                margin: 10px 0;
                font-size: 14px;
            }

            /* Compact progress bar */
            .progress-bar {
                height: 4px;
                margin-bottom: 15px;
            }

            .splash-content h1 {
                font-size: 36px;
            }

            .splash-content p {
                font-size: 18px;
            }

            /* Mobile responsive table */
            .responsive-table {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .responsive-table table {
                width: 105%;
                font-size: 12px;
                table-layout: fixed;
                min-width: 400px;
            }

            .responsive-table th,
            .responsive-table td {
                padding: 8px 6px !important;
                font-size: 12px !important;
                word-wrap: break-word;
                hyphens: auto;
                line-height: 1.3;
            }

            .responsive-table th {
                font-size: 12px !important;
                font-weight: 600;
            }

            /* Equal column widths for mobile (5 columns) */
            .responsive-table th:nth-child(1),
            .responsive-table td:nth-child(1) {
                width: 20%;
                min-width: 80px;
            }

            .responsive-table th:nth-child(2),
            .responsive-table td:nth-child(2) {
                width: 20%;
                min-width: 80px;
            }

            .responsive-table th:nth-child(3),
            .responsive-table td:nth-child(3) {
                width: 20%;
                min-width: 80px;
            }

            .responsive-table th:nth-child(4),
            .responsive-table td:nth-child(4) {
                width: 20%;
                min-width: 80px;
            }

            .responsive-table th:nth-child(5),
            .responsive-table td:nth-child(5) {
                width: 20%;
                min-width: 80px;
            }

            /* Additional mobile table optimizations */
            .responsive-table td {
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }

            /* Allow drug names (column 1) to wrap */
            .responsive-table td:nth-child(1) {
                white-space: normal;
                word-break: break-word;
                hyphens: auto;
            }

            /* Allow standard dose (column 3) to wrap */
            .responsive-table td:nth-child(3) {
                white-space: normal;
                word-break: break-word;
                hyphens: auto;
            }

            /* Allow schedule (column 4) to wrap on multiple lines */
            .responsive-table td:nth-child(4) {
                white-space: normal;
                word-break: break-word;
                hyphens: auto;
            }

            /* Compact result items - reduced patient summary box size */
            .result-item {
                padding: 8px;
                margin-bottom: 8px;
                font-size: 12px;
            }

            /* Mobile footer adjustments - ensure visibility */
            .app-footer {
                padding: 15px 0;
                margin-top: 25px;
                position: relative;
                z-index: 100;
                background: #f8f9fa;
            }

            .copyright-line {
                font-size: 13px;
                margin-bottom: 4px;
            }

            .brand-line {
                font-size: 12px;
            }

            .footer-content {
                padding: 0 15px;
            }
            
            /* Dose adjustment pages mobile styling - now using responsive table structure */
            #doseAdjustmentTable .responsive-table {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                width: 100%;
            }
            
            #doseAdjustmentTable .responsive-table table {
                width: 100%;
                font-size: 12px !important;
                table-layout: fixed;
                min-width: 500px;
                border-collapse: collapse;
            }
            
            #doseAdjustmentTable .responsive-table th {
                padding: 8px 6px !important;
                font-size: 12px !important;
                border: 1px solid #dee2e6;
                word-wrap: break-word;
                hyphens: auto;
                line-height: 1.3;
                vertical-align: middle;
                background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%) !important;
                color: #2c3e50 !important;
                font-weight: 600;
            }

            #doseAdjustmentTable .responsive-table td {
                padding: 8px 6px !important;
                font-size: 12px !important;
                border: 1px solid #e8f4f8 !important;
                word-wrap: break-word;
                hyphens: auto;
                line-height: 1.3;
                vertical-align: middle;
                background: #fafbfc !important;
            }

            #doseAdjustmentTable .responsive-table tbody tr:nth-child(even) td {
                background: #f1f8ff !important;
            }
            
            /* Page 4 table column widths for mobile */
            #doseAdjustmentTable .responsive-table th:nth-child(1),
            #doseAdjustmentTable .responsive-table td:nth-child(1) {
                width: 20%;
                min-width: 70px;
            }
            
            #doseAdjustmentTable .responsive-table th:nth-child(2),
            #doseAdjustmentTable .responsive-table td:nth-child(2) {
                width: 10%;
                min-width: 40px;
            }
            
            #doseAdjustmentTable .responsive-table th:nth-child(3),
            #doseAdjustmentTable .responsive-table td:nth-child(3) {
                width: 12%;
                min-width: 45px;
            }
            
            #doseAdjustmentTable .responsive-table th:nth-child(4),
            #doseAdjustmentTable .responsive-table td:nth-child(4) {
                width: 12%;
                min-width: 45px;
            }
            
            /* Allow drug names to wrap */
            #doseAdjustmentTable .responsive-table td:nth-child(1) {
                white-space: normal;
                word-break: break-word;
                hyphens: auto;
            }
            
            /* Keep other columns compact */
            #doseAdjustmentTable .responsive-table td:nth-child(2),
            #doseAdjustmentTable .responsive-table td:nth-child(4) {
                white-space: normal;
                word-break: break-word;
            }
            
            #doseAdjustmentTable .responsive-table td:nth-child(3) {
                text-align: center;
            }
            
            #doseAdjustmentTable input[type="number"] {
                padding: 4px 22px 4px 4px !important;
                font-size: 12px !important;
                width: 100% !important;
                min-width: 50px !important;
                box-sizing: border-box !important;
                border: 1px solid #ddd !important;
                border-radius: 3px !important;
            }
            
            #doseAdjustmentTable .percentage-symbol {
                right: 8px !important;
                font-size: 9px !important;
                top: 50% !important;
                transform: translateY(-50%);
                position: absolute;
                color: #666 !important;
                pointer-events: none;
                font-weight: 500 !important;
            }
            
            #patientSummary {
                font-size: 12px !important;
                padding: 10px !important;
            }
            
            /* Keep navigation buttons side by side on mobile */
            .nav-buttons {
                display: flex;
                flex-direction: row;
                gap: 8px;
                flex-wrap: wrap;
            }
            
            .nav-buttons .btn {
                flex: 1;
                min-width: 120px;
                margin: 0;
                padding: 10px 8px;
                font-size: 13px;
            }
            
            #globalReduction {
                width: 60px !important;
                font-size: 14px !important;
            }

            /* Smaller reduce column inputs for mobile to match global reduction input */
            #doseAdjustmentTable .responsive-table td:nth-child(3) input[type="number"] {
                width: 60px !important;
                max-width: 60px !important;
            }
            
            /* Final prescription table mobile */
            #finalResultsContent .responsive-table {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                width: 100%;
            }
            
            #finalResultsContent .responsive-table table {
                min-width: 600px;
                width: 100%;
                font-size: 13px !important;
                table-layout: fixed;
            }
            
            #finalResultsContent .responsive-table th,
            #finalResultsContent .responsive-table td {
                padding: 8px 4px !important;
                font-size: 12px !important;
                word-wrap: break-word;
                hyphens: auto;
                line-height: 1.3;
            }
            
            /* Fixed column widths for mobile final prescription table (6 columns) */
            #finalResultsContent .responsive-table th:nth-child(1),
            #finalResultsContent .responsive-table td:nth-child(1) {
                width: 18%;
                min-width: 70px;
            }
            
            #finalResultsContent .responsive-table th:nth-child(2),
            #finalResultsContent .responsive-table td:nth-child(2) {
                width: 15%;
                min-width: 60px;
            }
            
            #finalResultsContent .responsive-table th:nth-child(3),
            #finalResultsContent .responsive-table td:nth-child(3) {
                width: 15%;
                min-width: 60px;
            }
            
            #finalResultsContent .responsive-table th:nth-child(4),
            #finalResultsContent .responsive-table td:nth-child(4) {
                width: 15%;
                min-width: 60px;
            }
            
            #finalResultsContent .responsive-table th:nth-child(5),
            #finalResultsContent .responsive-table td:nth-child(5) {
                width: 15%;
                min-width: 60px;
            }
            
            #finalResultsContent .responsive-table th:nth-child(6),
            #finalResultsContent .responsive-table td:nth-child(6) {
                width: 22%;
                min-width: 80px;
            }
            
            /* Allow drug names and schedule to wrap */
            #finalResultsContent .responsive-table td:nth-child(1),
            #finalResultsContent .responsive-table td:nth-child(6) {
                white-space: normal;
                word-break: break-word;
            }
            
            /* Keep dose columns compact */
            #finalResultsContent .responsive-table td:nth-child(2),
            #finalResultsContent .responsive-table td:nth-child(3),
            #finalResultsContent .responsive-table td:nth-child(4),
            #finalResultsContent .responsive-table td:nth-child(5) {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            
            /* Make summary boxes more compact on mobile */
            #reductionSummary {
                padding: 8px !important;
                margin-top: 12px !important;
                border-width: 1px !important;
            }
            
            #reductionSummary h3 {
                font-size: 14px !important;
            }
            
            #reductionSummary .reduction-item {
                font-size: 12px !important;
                padding: 4px 0 !important;
            }
            
            /* More compact patient summary box */
            .result-item {
                padding: 6px !important;
                margin-bottom: 6px !important;
                font-size: 11px !important;
            }
            
            /* Compact caution message */
            .caution-message {
                padding: 8px !important;
                margin: 10px 0 !important;
                font-size: 11px !important;
            }
            
            .caution-message h4 {
                font-size: 12px !important;
                margin-bottom: 4px !important;
            }
            
            .caution-message ul li {
                font-size: 10px !important;
                margin-bottom: 2px !important;
            }
        }
        
    </style>
</head>
<body>
    <div class="container">
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
        </div>
        <!-- Splash Screen -->
        <div id="splashScreen" class="page active">
            <div class="splash-content">
            </div>
        </div>
        <!-- Page 1: Patient Information -->
        <div id="page1" class="page">
            <div class="form-section">
                <div class="page-title">
                    <div class="page-number">1</div>
                    <h2>Patient Information</h2>
                </div>
                
                <div class="form-group">
                    <label for="height">Height (cm)</label>
                    <input type="number" id="height" name="height" required min="100" max="250">
                </div>
                
                <div class="form-group">
                    <label for="weight">Weight (kg)</label>
                    <input type="number" id="weight" name="weight" required min="20" max="200" step="0.1">
                </div>

                <div class="form-group">
                    <label>Sex</label>
                    <div class="radio-group" style="display: flex; gap: 20px; margin-top: 10px;">
                        <label class="radio-option" style="display: flex; align-items: center; gap: 8px; margin-bottom: 0; cursor: pointer;">
                            <input type="radio" id="sexMale" name="sex" value="male" style="width: auto; margin: 0;">
                            <span>Male</span>
                        </label>
                        <label class="radio-option" style="display: flex; align-items: center; gap: 8px; margin-bottom: 0; cursor: pointer;">
                            <input type="radio" id="sexFemale" name="sex" value="female" style="width: auto; margin: 0;">
                            <span>Female</span>
                        </label>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button type="button" class="btn btn-primary" id="nextToPage2">Next: Select Regimen</button>
                </div>
            </div>
        </div>

        <!-- Page 2: Cancer & Protocol Selection -->
        <div id="page2" class="page">
            <div class="form-section">
                <div class="page-title">
                    <div class="page-number">2</div>
                    <h2>Regimen Selection</h2>
                </div>

                <!-- Search Section -->
                <div class="search-section" style="padding: 8px; margin-bottom: 12px;">
                    <div class="search-header" style="margin-bottom: 8px;">
                        <span class="search-icon" style="font-size: 14px;">🔍</span>
                        <h3 style="margin: 0; color: #2c3e50; font-size: 13px;">Quick Search (All Cancers)</h3>
                    </div>
                    <div class="search-input">
                        <div style="position: relative;">
                            <input type="text" id="protocolSearch" placeholder="Search regimens (e.g., FOLFOX, AC-T...)" style="width: 100%; padding: 6px 25px 6px 6px; border: 2px solid #ddd; border-radius: 4px; font-size: 13px;">
                            <button type="button" id="clearSearch" style="position: absolute; right: 4px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 12px; color: #999; cursor: pointer; width: 16px; height: 16px; display: none; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s;" onmouseover="this.style.backgroundColor='#f0f0f0'; this.style.color='#666'" onmouseout="this.style.backgroundColor='transparent'; this.style.color='#999'">×</button>
                        </div>
                        <div class="search-suggestions" id="searchSuggestions"></div>
                    </div>
                    <div class="selected-protocol-info" id="selectedProtocolInfo" style="padding: 6px; margin-top: 6px;">
                        <div class="selected-protocol-name" id="selectedProtocolName" style="font-size: 12px;"></div>
                        <div class="selected-protocol-cancer" id="selectedProtocolCancer" style="font-size: 10px;"></div>
                    </div>
                </div>

                <!-- Carboplatin Parameters for Quick Search (conditional) -->
                <div id="searchCarboplatinParams" style="display: none;">
                    <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                            <i class="fas fa-calculator" style="font-size: 18px; color: #e67e22;"></i>
                            <h3 style="margin: 0; color: #2c3e50; font-size: 16px;">Carboplatin Dosing Parameters</h3>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="searchAge">Age (years)</label>
                                <input type="number" id="searchAge" name="searchAge" min="1" max="120">
                            </div>
                            <div class="form-group">
                                <label for="searchCreatinine">Creatinine (mg/dL)</label>
                                <input type="number" id="searchCreatinine" name="searchCreatinine" min="0.3" max="15" step="0.1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="searchAuc">Carboplatin AUC</label>
                            <input type="number" id="searchAuc" name="searchAuc" min="1" max="10" step="0.1" placeholder="Enter AUC (e.g., 5, 6, 7)">
                        </div>
                    </div>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <!-- Browse Section -->
                <div class="browse-section" style="padding: 18px; margin-bottom: 15px;">
                    <div class="browse-header">
                        <i class="fas fa-clipboard-list" style="font-size: 20px; color: #e67e22;"></i>
                        <h3 style="margin: 0; color: #2c3e50;">Browse by Cancer Type</h3>
                    </div>
                    
                    <div class="form-group">
                        <label for="cancerType">Cancer Type</label>
                        <select id="cancerType" name="cancerType">
                            <option value="">Select cancer type</option>
                            <option value="adrenocortical">Adrenocortical Cancer</option>
                            <option value="anal">Anal Cancer</option>
                            <option value="basal_cell">Basal Cell Carcinoma</option>
                            <option value="biliary">Biliary Tract Cancer</option>
                            <option value="bladder">Bladder Cancer</option>
                            <option value="bone">Bone Cancer</option>
                            <option value="brain">Brain Cancer</option>
                            <option value="breast">Breast Cancer</option>
                            <option value="carcinoma_unknown_primary">Carcinoma of Unknown Primary</option>
                            <option value="cervical">Cervical Cancer</option>
                            <option value="colorectal">Colorectal Cancer</option>
                            <option value="endometrial">Endometrial Cancer</option>
                            <option value="esophageal">Esophageal & Esophagogastric Junction Cancer</option>
                            <option value="gastric">Gastric Cancer</option>
                            <option value="gist">Gastrointestinal Stromal Tumor (GIST)</option>
                            <option value="head_neck">Head & Neck Cancer</option>
                            <option value="hepatocellular">Hepatocellular Carcinoma</option>
                            <option value="leukemia">Leukemia</option>
                            <option value="lung">Lung Cancer</option>
                            <option value="lymphoma">Lymphoma</option>
                            <option value="melanoma">Malignant Melanoma</option>
                            <option value="merkel_cell">Merkel Cell Carcinoma</option>
                            <option value="mesothelioma">Mesothelioma</option>
                            <option value="multiple_myeloma">Multiple Myeloma</option>
                            <option value="neuroendocrine">Neuroendocrine Tumors</option>
                            <option value="ovarian">Ovarian Cancer</option>
                            <option value="pancreatic">Pancreatic Cancer</option>
                            <option value="penile">Penile Cancer</option>
                            <option value="prostate">Prostate Cancer</option>
                            <option value="renal">Renal Cell Cancer</option>
                            <option value="sarcoma">Soft Tissue Sarcoma</option>
                            <option value="testicular">Testicular Cancer</option>
                            <option value="thymoma">Thymoma</option>
                            <option value="thyroid">Thyroid Cancer</option>
                            <option value="stem_cell_transplant">Stem Cell Transplant Conditioning</option>
                            <option value="tumor_agnostic">Tumor Agnostic Therapy</option>
                            <option value="vulvar_vaginal">Vulvar & Vaginal Cancer</option>
                        </select>
                    </div>

                    <div class="form-group" id="subtypeGroup" style="display: none;">
                        <label for="cancerSubtype">Cancer Subtype</label>
                        <select id="cancerSubtype" name="cancerSubtype" disabled>
                            <option value="">Select subtype</option>
                        </select>
                    </div>

                    <!-- Cancer-Specific Search -->
                    <div class="form-group" id="cancerSearchGroup" style="display: none;">
                        <label for="cancerSpecificSearchInput">Search Regimens in Selected Cancer Type</label>
                        <div style="position: relative;">
                            <input type="text" id="cancerSpecificSearchInput" placeholder="Type drug name to search regimens..." style="width: 100%; padding: 12px 30px 12px 12px; border: 2px solid #ddd; border-radius: 5px; font-size: 16px;" disabled>
                            <button type="button" id="clearCancerSearch" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 16px; color: #999; cursor: pointer; width: 20px; height: 20px; display: none; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s;" onmouseover="this.style.backgroundColor='#f0f0f0'; this.style.color='#666'" onmouseout="this.style.backgroundColor='transparent'; this.style.color='#999'">×</button>
                            <div id="cancerSearchDropdown" style="position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-top: none; border-radius: 0 0 5px 5px; max-height: 200px; overflow-y: auto; z-index: 1000; display: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                <!-- Search results will appear here -->
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="protocol">Scroll to Select Regimen</label>
                        <select id="protocol" name="protocol" disabled>
                            <option value="">Select regimen</option>
                        </select>
                    </div>
                </div>

                <!-- Carboplatin Parameters (conditional) -->
                <div id="carboplatinParams" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="age">Age (years)</label>
                            <input type="number" id="age" name="age" min="1" max="120">
                        </div>
                        <div class="form-group">
                            <label for="creatinine">Creatinine (mg/dL)</label>
                            <input type="number" id="creatinine" name="creatinine" min="0.3" max="15" step="0.1">
                        </div>
                    </div>
                </div>

                <div class="form-group" id="aucGroup" style="display: none;">
                    <label for="auc">Carboplatin AUC</label>
                    <input type="number" id="auc" name="auc" min="1" max="10" step="0.1" placeholder="Enter AUC (e.g., 5, 6, 7)">
                </div>

                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" id="backToPage1">Back</button>
                    <button type="button" class="btn btn-primary" id="calculateDoses">Calculate Doses</button>
                </div>
            </div>
        </div>

        <!-- Page 3: Results -->
        <div id="page3" class="page">
            <div class="form-section">
                <div class="page-title">
                    <div class="page-number">3</div>
                    <h2>Regimen & Dose Results</h2>
                </div>
                
                <div id="resultsContent"></div>

                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" id="backToPage2">Back to Regimen Selection</button>
                    <button type="button" class="btn btn-primary" id="adjustDoses">Adjust Doses</button>
                    <button type="button" class="btn btn-primary" id="startOver">Start New Calculation</button>
                </div>
            </div>
        </div>

        <!-- Page 4: Dose Adjustment -->
        <div id="page4" class="page">
            <div class="form-section">
                <div class="page-title">
                    <div class="page-number">4</div>
                    <h2>Dose Adjustment</h2>
                </div>
                
                <!-- Quick Actions -->
                <div style="background: #fff; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px; margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <i class="fas fa-sliders-h" style="font-size: 18px; color: #8e44ad;"></i>
                        <h3 style="margin: 0; color: #2c3e50; font-size: 16px;">Quick Actions</h3>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <label style="margin: 0;">Reduce all doses by:</label>
                        <input type="number" id="globalReduction" placeholder="%" min="0" max="100" style="width: 80px; padding: 8px; border: 2px solid #ddd; border-radius: 4px; font-size: 14px;">
                        <button type="button" class="btn btn-primary" id="applyGlobalReduction" style="padding: 8px 16px; font-size: 14px;">Apply to All</button>
                        <button type="button" class="btn btn-secondary" id="resetReductions" style="padding: 8px 16px; font-size: 14px;">Reset</button>
                    </div>
                </div>

                <!-- Individual Drug Adjustments -->
                <div style="background: #fff; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px; margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                        <span style="font-size: 18px;">💊</span>
                        <h3 style="margin: 0; color: #2c3e50; font-size: 16px;">Individual Drug Adjustments</h3>
                    </div>
                    
                    <div id="doseAdjustmentTable">
                        <!-- Drug adjustment rows will be populated here -->
                    </div>
                </div>

                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" id="backToPage3">Back to Results</button>
                    <button type="button" class="btn btn-primary" id="finalDoses">Final Doses</button>
                </div>
            </div>
        </div>

        <!-- Page 5: Final Prescription -->
        <div id="page5" class="page">
            <div class="form-section">
                <div class="page-title">
                    <div class="page-number">5</div>
                    <h2>Final Prescription Doses</h2>
                </div>
                
                <div id="finalResultsContent"></div>

                <!-- Dose Reductions Summary -->
                <div id="reductionSummary" style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px; margin-top: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <i class="fas fa-file-medical" style="font-size: 18px; color: #8e44ad;"></i>
                        <h3 style="margin: 0; color: #2c3e50; font-size: 16px;">Dose Reductions Applied</h3>
                    </div>
                    <div id="reductionList">
                        <!-- Reduction summary will be populated here -->
                    </div>
                </div>

                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" id="backToPage4">Back to Adjust</button>
                    <button type="button" class="btn btn-primary" id="newCalculationFromPage5">New Calculation</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Copyright Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="copyright-line">© 2025 Dr. Prathyusha Eaga</div>
            <div class="brand-line">OncoCalcRx - All rights reserved.</div>
        </div>
    </footer>

    <!-- Analytics Tracking Script -->
    <script>
        // Analytics Helper Functions
        function trackEvent(eventName, parameters = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, {
                    custom_parameter_1: parameters.custom_parameter_1 || '',
                    custom_parameter_2: parameters.custom_parameter_2 || '',
                    custom_parameter_3: parameters.custom_parameter_3 || '',
                    value: parameters.value || null,
                    ...parameters
                });
            }
        }

        function trackPageView(pageName) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'page_view', {
                    page_title: `OncoCalcRx - ${pageName}`,
                    page_location: window.location.href,
                    custom_parameter_1: pageName
                });
            }
        }

        // Track app initialization
        trackEvent('app_start', {
            timestamp: new Date().toISOString(),
            user_agent: navigator.userAgent,
            screen_resolution: `${screen.width}x${screen.height}`
        });
    </script>

    <script>
        // Splash screen logic
        document.addEventListener('DOMContentLoaded', function() {
            // Ensure splash screen is visible on all devices
            const splashScreen = document.getElementById('splashScreen');
            const page1 = document.getElementById('page1');
            
            // Force show splash screen initially
            splashScreen.style.display = 'block';
            splashScreen.classList.add('active');
            page1.classList.remove('active');
            
            // Auto-transition from splash screen to page 1 after 1.5 seconds
            setTimeout(function() {
                splashScreen.classList.remove('active');
                page1.classList.add('active');
                // Update progress bar to show page 1
                document.getElementById('progressFill').style.width = '33%';
            }, 1500);
            
            // Radio buttons handle mutual exclusion automatically - no additional code needed
            // Optional: Add visual feedback for radio button selection
            const radioOptions = document.querySelectorAll('.radio-option');
            radioOptions.forEach(option => {
                const radioInput = option.querySelector('input[type="radio"]');
                
                option.addEventListener('click', function(e) {
                    if (e.target !== radioInput) {
                        radioInput.checked = true;
                        // Trigger change event for any validation logic
                        radioInput.dispatchEvent(new Event('change'));
                    }
                });
            });

            // Clear search functionality
            const protocolSearchInput = document.getElementById('protocolSearch');
            const clearSearchButton = document.getElementById('clearSearch');
            
            // Show/hide clear button based on input content
            function toggleClearButton() {
                if (protocolSearchInput.value.trim() !== '') {
                    clearSearchButton.style.display = 'flex';
                } else {
                    clearSearchButton.style.display = 'none';
                }
            }
            
            // Listen for input changes to show/hide clear button
            protocolSearchInput.addEventListener('input', toggleClearButton);
            protocolSearchInput.addEventListener('focus', toggleClearButton);
            
            // Clear search when X button is clicked
            clearSearchButton.addEventListener('click', function() {
                protocolSearchInput.value = '';
                protocolSearchInput.focus();
                clearSearchButton.style.display = 'none';
                
                // Hide search suggestions and selected protocol info
                const searchSuggestions = document.getElementById('searchSuggestions');
                const selectedProtocolInfo = document.getElementById('selectedProtocolInfo');
                if (searchSuggestions) searchSuggestions.style.display = 'none';
                if (selectedProtocolInfo) selectedProtocolInfo.style.display = 'none';
                
                // Hide search carboplatin parameters
                const searchCarboplatinParams = document.getElementById('searchCarboplatinParams');
                if (searchCarboplatinParams) {
                    searchCarboplatinParams.style.display = 'none';
                    // Clear the values and remove required attributes
                    const searchAge = document.getElementById('searchAge');
                    const searchCreatinine = document.getElementById('searchCreatinine');
                    const searchAuc = document.getElementById('searchAuc');
                    if (searchAge) {
                        searchAge.value = '';
                        searchAge.required = false;
                    }
                    if (searchCreatinine) {
                        searchCreatinine.value = '';
                        searchCreatinine.required = false;
                    }
                    if (searchAuc) {
                        searchAuc.value = '';
                        searchAuc.required = false;
                    }
                }
                
                // Clear selected search protocol
                selectedSearchProtocol = null;
                
                // Trigger input event to reset any search filters
                protocolSearchInput.dispatchEvent(new Event('input', { bubbles: true }));
            });
            
            // Cancer-specific search clear functionality
            const cancerSearchInput = document.getElementById('cancerSpecificSearchInput');
            const clearCancerSearchButton = document.getElementById('clearCancerSearch');
            
            // Show/hide clear button for cancer search based on input content
            function toggleCancerClearButton() {
                if (cancerSearchInput.value.trim() !== '') {
                    clearCancerSearchButton.style.display = 'flex';
                } else {
                    clearCancerSearchButton.style.display = 'none';
                }
            }
            
            // Listen for input changes to show/hide clear button
            cancerSearchInput.addEventListener('input', toggleCancerClearButton);
            cancerSearchInput.addEventListener('focus', toggleCancerClearButton);
            
            // Clear cancer search when X button is clicked
            clearCancerSearchButton.addEventListener('click', function() {
                cancerSearchInput.value = '';
                cancerSearchInput.focus();
                clearCancerSearchButton.style.display = 'none';
                
                // Hide cancer search dropdown
                const cancerSearchDropdown = document.getElementById('cancerSearchDropdown');
                if (cancerSearchDropdown) cancerSearchDropdown.style.display = 'none';
                
                // Hide browse section carboplatin parameters (since cancer search is part of browse)
                const carboplatinParams = document.getElementById('carboplatinParams');
                const aucGroup = document.getElementById('aucGroup');
                if (carboplatinParams) {
                    carboplatinParams.style.display = 'none';
                    // Clear the values and remove required attributes
                    const age = document.getElementById('age');
                    const creatinine = document.getElementById('creatinine');
                    if (age) {
                        age.value = '';
                        age.required = false;
                    }
                    if (creatinine) {
                        creatinine.value = '';
                        creatinine.required = false;
                    }
                }
                if (aucGroup) {
                    aucGroup.style.display = 'none';
                    const auc = document.getElementById('auc');
                    if (auc) {
                        auc.value = '';
                        auc.required = false;
                    }
                }
                
                // Clear selected cancer search protocol
                selectedCancerSearchProtocol = null;
                
                // Reset protocol dropdown selection
                const protocolDropdown = document.getElementById('protocol');
                if (protocolDropdown) {
                    protocolDropdown.value = '';
                }
                
                // Trigger input event to reset any search filters
                cancerSearchInput.dispatchEvent(new Event('input', { bubbles: true }));
            });
        });
    </script>
    <script src="app.js"></script>
</body>
</html>